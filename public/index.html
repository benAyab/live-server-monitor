<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport"  content="width=device-width, initial-scale=1.0"/>
        <title> Live monitor</title>
        <style type="text/css">
            *{
                margin: 0;
                box-sizing: border-box;
                max-width: 100vw;
                max-height: 100vh;
            }
            body{
                background-color: rgb(43, 46, 45);
                font-family: 'Poppins' sans-serif;
            }
            .maincontainer{
                position: relative;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }
            .authorname{
                position: absolute;
                top: 8px;
                left: 50px;
                padding: 5px;
                cursor: none;
            }
            .section-nav{
                position: absolute;
                top: 8px;
                right: 50px;
                padding: 5px;
                cursor: pointer;
                border-top-right-radius: 15px;
                border-bottom-right-radius: 15px;
            }
            .section-nav h4 a{
                text-decoration: none;
            }
            h3{
                text-align: center;
                margin: auto;
                padding: 5px;
            }
            .value{
                font-size: small;
                font-weight: bold;
                font-style: normal;
            }
            .name{
                display: inline-block;
            }
            .blockinfo{
                right: 30px;
                margin: auto;
                width: 50%;
                margin-top: 5px;
                transition: .5s ease all ;
            }
            .border-style{
                border: none;
                background-color: lightblue;
                border-left: #0fdffd 1px solid;
                border-top-left-radius: 15px;
                border-bottom-left-radius: 15px;
            }
            .cpu{
                position: absolute;
                top: 60px;
                height: 250px;
            }
            .mem{
                position: absolute;
                top: 350px;
                height: 200px;
            }

            .trans:hover{
                transform: scaleX(1.15);
                -moz-transform: scaleX(1.15);
                -webkit-transform: scaleX(1.15);
                cursor: pointer;
            }
            .blockinfosys{
                position: absolute;
                top: 60px;
                left: 50px;
                height: 200px;
                width: 380px;
                transition: .5s ease all ;
            }
            ul{
                list-style: none;
            }
            ul li{
                margin: 15px;
                padding: 5px;
                height: 20px;
                line-height: 15px;
            }
            .uptime{
                position: absolute;
                padding: 5px;
                left: 50px;
                top: 290px;
            }
            h4{
                text-align: center;
            }

            @media only screen and ( max-width: 980px){
                .authorname{
                    position: fixed;
                    top: 10px;
                    left: 20px;
                    padding: 5px;
                    font-size: small;
                }
                .value, .name {
                    font-size: smaller;  
                }

                .cpu{
                    position: absolute;
                    top: 75px;
                    height: 280px;
                }
                .mem{
                    position: absolute;
                    top: 400px;
                    height: 180px;
                }

                .blockinfosys{
                    position: absolute;
                    top: 75px;
                    left: 20px;
                    height: 180px;
                    width: 300px;
                    transition: .5s ease all ;
                }
                .uptime{
                    position: absolute;
                    left: 20px;
                    top: 290px;
                }
            }
        </style>

    </head>
    <body onload="getinitialvalues()">
        <div class="maincontainer">
            <div class="authorname  border-style">
               <h4>By GONGMOGA KIDANDI Henri & GUIGABE Victor </h4>
            </div>

            <div class="section-nav border-style">
                <h4> <a href="/config">Configurer la notification</a> </h4>
            </div>
            <div class="uptime trans border-style"> 
                <span> En service depuis: </span>
                <h4> <span id="uptime"></span> </h4>
            </div>
            <div class="blockinfo trans cpu border-style">
                <h3> Processeur</h3>
                <ul>
                    <li> <span class="name">Modèle: </span> <span class="value" id="cpumodel"></span> </li>
                    <li> <span class="name">Processeurs logiques : </span> <span class="value" id="cpulog"></span></li>
                    <li> <span class="name">Architecture : </span> <span class="value" id="cpuarch"></span> </li>
                    <li> <span class="name">Vitesse Max: </span> <span class="value" id="cpuspeed"></span> </li>
                    <li> <span class="name">utilisation : </span> <span class="value" id="cpusage"></span> </li>
                </ul>
            </div>
            <div class="blockinfo trans mem border-style">
                <h3> Mémoire</h3>
                <ul>
                    <li> <span class="name">Totale : </span>  <span class="value" id='totalmem'></span> </li>
                    <li> <span class="name">En cours d'utilisation: </span> <span class="value" id='usedmem'></span> </li>
                    <li> <span class="name">Disponible : </span> <span class="value" id='freemem'></span> </li>
                    <li> <span class="name"> Disponible (%) : </span> <span class="value" id='freePercentagemem'></span> </li>
                </ul>
            </div>
            <div class="blockinfosys trans border-style">
                <h4> Système et hôte</h4>
                <ul>
                    <li> <span class="name">Plateforme: </span> <span class="value" id='osplatform'></span> </li>
                    <li> <span class="name">Type : </span> <span class="value" id='osptype'></span> </li>
                    <li> <span class="name">Nom de la machine : </span> <span class="value" id='hostname'></span> </li>
                    <li> <span class="name">Utilisateur : </span> <span class="value" id='username'></span> </li>
                </ul>
            </div>
        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io();
            function getinitialvalues(){
                socket.emit('getfirstvalues');
            }
            socket.on('firstval', function(initalvalues){
                obj = JSON.parse(initalvalues);
                document.getElementById('uptime').innerText = obj.osuptime;

                document.getElementById('cpumodel').innerText = obj.cpumodel;
                document.getElementById('cpulog').innerText = obj.cpulog;
                document.getElementById('cpuarch').innerText = obj.cpuarch;
                document.getElementById('cpusage').innerText = obj.cpusage;
                document.getElementById('cpuspeed').innerText = obj.cpuspeed + 'GHz';

                document.getElementById('totalmem').innerText = obj.totalmem+' Go';
                document.getElementById('usedmem').innerText = obj.usedmem+' Go';
                document.getElementById('freemem').innerText = obj.freemem+' Go';
                document.getElementById('freePercentagemem').innerText = obj.freePercentagemem+'%';

                document.getElementById('osplatform').innerText = obj.osplatform;
                document.getElementById('osptype').innerText = obj.osptype;
                document.getElementById('hostname').innerText = obj.hostname;
                document.getElementById('username').innerText = obj.username;
            })
            socket.on('update', function(updates){
                let update = JSON.parse(updates);
                document.getElementById('uptime').innerText = update.osuptime;
                document.getElementById('usedmem').innerText = update.usedmem+' Go';
                document.getElementById('freemem').innerText = update.freemem+' Go';
                document.getElementById('freePercentagemem').innerText = update.freePercentagemem+'%';
                document.getElementById('cpusage').innerText = update.cpusage+'%';
            })
        </script>
    </body>
</html>